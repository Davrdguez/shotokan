---
// src/components/common/Header.astro
// Header responsive, sin React. Astro + Tailwind.
// Menú lateral en móvil con animación de slide desde la izquierda.
// Adaptado a Shotokan Valladolid (etiquetas en ES).
const nav = [
  { href: "/", label: "Inicio" },
  { href: "/classes", label: "Actividades" },
  { href: "/schedule", label: "Horarios" },
  { href: "/blog", label: "Blog" },
  { href: "/contact", label: "Contacto" },
];
---

<header class="sticky top-0 z-50 bg-bg/80 backdrop-blur border-b border-border/40">
  <div class="container h-16 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="font-bold tracking-wide text-fg text-lg md:text-xl">
      Shotokan Valladolid
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center gap-8 text-sm text-fg/80">
      {nav.map((item) => (
        <a href={item.href} class="hover:text-fg transition-colors">{item.label}</a>
      ))}
      <a
        href="/contact"
        class="inline-flex items-center rounded-full bg-fg px-4 py-2 text-xs font-semibold text-bg hover:opacity-90 transition"
      >
        Reservar clase
      </a>
    </nav>

    <!-- Mobile Hamburger -->
    <button
      class="md:hidden inline-flex items-center justify-center w-10 h-10 rounded-md border border-border text-fg"
      aria-label="Abrir menú"
      aria-controls="mobile-drawer"
      aria-expanded="false"
      id="menu-toggle"
    >
      <!-- Icon hamburger -->
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
  </div>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 z-40 hidden bg-black/50"></div>

  <!-- Mobile Drawer -->
  <aside
    id="mobile-drawer"
    class="fixed left-0 top-0 z-50 h-dvh w-80 max-w-[85%] -translate-x-full bg-bg border-r border-border/40 transition-transform duration-300 ease-out"
    tabindex="-1"
    aria-hidden="true"
  >
    <div class="flex items-center justify-between h-16 px-4 border-b border-border/40">
      <a href="/" class="font-bold text-fg">Shotokan Valladolid</a>
      <button
        id="menu-close"
        class="inline-flex items-center justify-center w-10 h-10 rounded-md border border-border text-fg"
        aria-label="Cerrar menú"
      >
        <!-- Icon close -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <nav class="p-6 flex flex-col gap-6 text-base text-fg/90">
      {nav.map((item) => (
        <a href={item.href} class="hover:text-fg transition-colors">{item.label}</a>
      ))}
      <a
        href="/contact"
        class="mt-2 inline-flex items-center justify-center rounded-lg bg-fg px-5 py-3 text-sm font-semibold text-bg hover:opacity-90 transition"
      >
        Reservar clase
      </a>
    </nav>
  </aside>

  <!-- JS mínimo para abrir/cerrar -->
  <script is:inline>
    const toggle = document.getElementById('menu-toggle');
    const closeBtn = document.getElementById('menu-close');
    const drawer = document.getElementById('mobile-drawer');
    const overlay = document.getElementById('overlay');

    const openMenu = () => {
      drawer.classList.remove('-translate-x-full');
      overlay.classList.remove('hidden');
      toggle.setAttribute('aria-expanded', 'true');
      drawer.removeAttribute('aria-hidden');
      document.documentElement.style.overflow = 'hidden';
      drawer.focus();
    };

    const closeMenu = () => {
      drawer.classList.add('-translate-x-full');
      overlay.classList.add('hidden');
      toggle.setAttribute('aria-expanded', 'false');
      drawer.setAttribute('aria-hidden', 'true');
      document.documentElement.style.overflow = '';
      toggle.focus();
    };

    toggle?.addEventListener('click', openMenu);
    closeBtn?.addEventListener('click', closeMenu);
    overlay?.addEventListener('click', closeMenu);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !drawer.classList.contains('-translate-x-full')) {
        closeMenu();
      }
    });

    drawer.querySelectorAll('a').forEach((a) => a.addEventListener('click', closeMenu));
  </script>
</header>
